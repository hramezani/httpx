


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A next-generation HTTP client for Python.">
      
      
        <link rel="canonical" href="https://www.python-httpx.org/advanced/">
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.0">
    
    
      
        <title>Advanced Usage - HTTPX</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.18ac144a.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://www.python-httpx.org/" title="HTTPX" class="md-header-nav__button md-logo" aria-label="HTTPX">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            HTTPX
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Advanced Usage
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/encode/httpx/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    encode/httpx
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.python-httpx.org/" title="HTTPX" class="md-nav__button md-logo" aria-label="HTTPX">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    HTTPX
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/encode/httpx/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    encode/httpx
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quickstart/" title="QuickStart" class="md-nav__link">
      QuickStart
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Advanced Usage
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Advanced Usage" class="md-nav__link md-nav__link--active">
      Advanced Usage
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-instances" class="md-nav__link">
    Client Instances
  </a>
  
    <nav class="md-nav" aria-label="Client Instances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-use-a-client" class="md-nav__link">
    Why use a Client?
  </a>
  
    <nav class="md-nav" aria-label="Why use a Client?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-efficient-usage-of-network-resources" class="md-nav__link">
    More efficient usage of network resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-features" class="md-nav__link">
    Extra features
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-requests" class="md-nav__link">
    Making requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing-configuration-across-requests" class="md-nav__link">
    Sharing configuration across requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merging-of-configuration" class="md-nav__link">
    Merging of configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-client-only-configuration-options" class="md-nav__link">
    Other Client-only configuration options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calling-into-python-web-apps" class="md-nav__link">
    Calling into Python Web Apps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-instances" class="md-nav__link">
    Request instances
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netrc-support" class="md-nav__link">
    .netrc Support
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-proxying" class="md-nav__link">
    HTTP Proxying
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout-configuration" class="md-nav__link">
    Timeout Configuration
  </a>
  
    <nav class="md-nav" aria-label="Timeout Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-and-disabling-timeouts" class="md-nav__link">
    Setting and disabling timeouts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-a-default-timeout-on-a-client" class="md-nav__link">
    Setting a default timeout on a client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-the-configuration" class="md-nav__link">
    Fine tuning the configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pool-limit-configuration" class="md-nav__link">
    Pool limit configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multipart-file-encoding" class="md-nav__link">
    Multipart file encoding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-authentication" class="md-nav__link">
    Customizing authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssl-certificates" class="md-nav__link">
    SSL certificates
  </a>
  
    <nav class="md-nav" aria-label="SSL certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#changing-the-verification-defaults" class="md-nav__link">
    Changing the verification defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-configuration-on-client-instances" class="md-nav__link">
    SSL configuration on client instances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-https-requests-to-a-local-server" class="md-nav__link">
    Making HTTPS requests to a local server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-transports" class="md-nav__link">
    Custom Transports
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../async/" title="Async Support" class="md-nav__link">
      Async Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../http2/" title="HTTP/2 Support" class="md-nav__link">
      HTTP/2 Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../environment_variables/" title="Environment Variables" class="md-nav__link">
      Environment Variables
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../compatibility/" title="Requests Compatibility" class="md-nav__link">
      Requests Compatibility
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="Developer Interface" class="md-nav__link">
      Developer Interface
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../third-party-packages/" title="Third Party Packages" class="md-nav__link">
      Third Party Packages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-instances" class="md-nav__link">
    Client Instances
  </a>
  
    <nav class="md-nav" aria-label="Client Instances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-use-a-client" class="md-nav__link">
    Why use a Client?
  </a>
  
    <nav class="md-nav" aria-label="Why use a Client?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-efficient-usage-of-network-resources" class="md-nav__link">
    More efficient usage of network resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-features" class="md-nav__link">
    Extra features
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-requests" class="md-nav__link">
    Making requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing-configuration-across-requests" class="md-nav__link">
    Sharing configuration across requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merging-of-configuration" class="md-nav__link">
    Merging of configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-client-only-configuration-options" class="md-nav__link">
    Other Client-only configuration options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calling-into-python-web-apps" class="md-nav__link">
    Calling into Python Web Apps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-instances" class="md-nav__link">
    Request instances
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netrc-support" class="md-nav__link">
    .netrc Support
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-proxying" class="md-nav__link">
    HTTP Proxying
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout-configuration" class="md-nav__link">
    Timeout Configuration
  </a>
  
    <nav class="md-nav" aria-label="Timeout Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-and-disabling-timeouts" class="md-nav__link">
    Setting and disabling timeouts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-a-default-timeout-on-a-client" class="md-nav__link">
    Setting a default timeout on a client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-the-configuration" class="md-nav__link">
    Fine tuning the configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pool-limit-configuration" class="md-nav__link">
    Pool limit configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multipart-file-encoding" class="md-nav__link">
    Multipart file encoding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-authentication" class="md-nav__link">
    Customizing authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssl-certificates" class="md-nav__link">
    SSL certificates
  </a>
  
    <nav class="md-nav" aria-label="SSL certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#changing-the-verification-defaults" class="md-nav__link">
    Changing the verification defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-configuration-on-client-instances" class="md-nav__link">
    SSL configuration on client instances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-https-requests-to-a-local-server" class="md-nav__link">
    Making HTTPS requests to a local server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-transports" class="md-nav__link">
    Custom Transports
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="advanced-usage">Advanced Usage</h1>
<h2 id="client-instances">Client Instances</h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If you are coming from Requests, <code>httpx.Client()</code> is what you can use instead of <code>requests.Session()</code>.</p>
</div>
<h3 id="why-use-a-client">Why use a Client?</h3>
<div class="admonition note">
<p class="admonition-title">TL;DR</p>
<p>If you do anything more than experimentation, one-off scripts, or prototypes, then you should use a <code>Client</code> instance.</p>
</div>
<h4 id="more-efficient-usage-of-network-resources">More efficient usage of network resources</h4>
<p>When you make requests using the top-level API as documented in the <a href="/quickstart">Quickstart</a> guide, HTTPX has to establish a new connection <em>for every single request</em> (connections are not reused). As the number of requests to a host increases, this quickly becomes inefficient.</p>
<p>On the other hand, a <code>Client</code> instance uses <a href="https://en.wikipedia.org/wiki/HTTP_persistent_connection">HTTP connection pooling</a>. This means that when you make several requests to the same host, the <code>Client</code> will reuse the underlying TCP connection, instead of recreating one for every single request.</p>
<p>This can bring <strong>significant performance improvements</strong> compared to using the top-level API, including:</p>
<ul>
<li>Reduced latency across requests (no handshaking).</li>
<li>Reduced CPU usage and round-trips.</li>
<li>Reduced network congestion.</li>
</ul>
<h4 id="extra-features">Extra features</h4>
<p><code>Client</code> instances also support features that aren't available at the top-level API, such as:</p>
<ul>
<li>Cookie persistance across requests.</li>
<li>Applying configuration across all outgoing requests.</li>
<li>Sending requests through HTTP proxies.</li>
<li>Using <a href="/http2">HTTP/2</a>.</li>
</ul>
<p>The other sections on this page go into further detail about what you can do with a <code>Client</code> instance.</p>
<h3 id="usage">Usage</h3>
<p>The recommended way to use a <code>Client</code> is as a context manager. This will ensure that connections are properly cleaned up when leaving the <code>with</code> block:</p>
<div class="codehilite"><pre><span></span><code><span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>


<p>Alternatively, you can explicitly close the connection pool without block-usage using <code>.close()</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>


<h3 id="making-requests">Making requests</h3>
<p>Once you have a <code>Client</code>, you can send requests using <code>.get()</code>, <code>.post()</code>, etc. For example:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span>
<span class="o">&lt;</span><span class="n">Response</span> <span class="p">[</span><span class="mi">200</span> <span class="n">OK</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div>


<p>These methods accept the same arguments as <code>httpx.get()</code>, <code>httpx.post()</code>, etc. This means that all features documented in the <a href="/quickstart">Quickstart</a> guide are also available at the client level.</p>
<p>For example, to send a request with custom headers:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X-Custom&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">}</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Custom&#39;</span><span class="p">]</span>
<span class="s1">&#39;value&#39;</span>
</code></pre></div>


<h3 id="sharing-configuration-across-requests">Sharing configuration across requests</h3>
<p>Clients allow you to apply configuration to all outgoing requests by passing parameters to the <code>Client</code> constructor.</p>
<p>For example, to apply a set of custom headers <em>on every request</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://httpbin.org/headers&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;user-agent&#39;</span><span class="p">:</span> <span class="s1">&#39;my-app/0.0.1&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;headers&#39;</span><span class="p">][</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">]</span>
<span class="s1">&#39;my-app/0.0.1&#39;</span>
</code></pre></div>


<h3 id="merging-of-configuration">Merging of configuration</h3>
<p>When a configuration option is provided at both the client-level and request-level, one of two things can happen:</p>
<ul>
<li>For headers, query parameters and cookies, the values are combined together. For example:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X-Auth&#39;</span><span class="p">:</span> <span class="s1">&#39;from-client&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="s1">&#39;client1&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X-Custom&#39;</span><span class="p">:</span> <span class="s1">&#39;from-request&#39;</span><span class="p">}</span>
<span class="o">...</span>     <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;request_id&#39;</span><span class="p">:</span> <span class="s1">&#39;request1&#39;</span><span class="p">}</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span>
<span class="n">URL</span><span class="p">(</span><span class="s1">&#39;https://example.com?client_id=client1&amp;request_id=request1&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Auth&#39;</span><span class="p">]</span>
<span class="s1">&#39;from-client&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Custom&#39;</span><span class="p">]</span>
<span class="s1">&#39;from-request&#39;</span>
</code></pre></div>


<ul>
<li>For all other parameters, the request-level value takes priority. For example:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;tom&#39;</span><span class="p">,</span> <span class="s1">&#39;mot123&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;alice&#39;</span><span class="p">,</span> <span class="s1">&#39;ecila123&#39;</span><span class="p">))</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">auth</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">base64</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
<span class="sa">b</span><span class="s1">&#39;alice:ecila123&#39;</span>
</code></pre></div>


<p>If you need finer-grained control on the merging of client-level and request-level parameters, see <a href="#request-instances">Request instances</a>.</p>
<h3 id="other-client-only-configuration-options">Other Client-only configuration options</h3>
<p>Additionally, <code>Client</code> accepts some configuration options that aren't available at the request level.</p>
<p>For example, <code>base_url</code> allows you to prepend an URL to all outgoing requests:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;http://httpbin.org&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/headers&#39;</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span>
<span class="n">URL</span><span class="p">(</span><span class="s1">&#39;http://httpbin.org/headers&#39;</span><span class="p">)</span>
</code></pre></div>


<p>For a list of all available client parameters, see the <a href="/api/#client"><code>Client</code></a> API reference.</p>
<h2 id="calling-into-python-web-apps">Calling into Python Web Apps</h2>
<p>You can configure an <code>httpx</code> client to call directly into a Python web application using the WSGI protocol.</p>
<p>This is particularly useful for two main use-cases:</p>
<ul>
<li>Using <code>httpx</code> as a client inside test cases.</li>
<li>Mocking out external services during tests or in dev/staging environments.</li>
</ul>
<p>Here's an example of integrating against a Flask application:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">import</span> <span class="nn">httpx</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span>

<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;http://testserver&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
    <span class="k">assert</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;Hello World!&quot;</span>
</code></pre></div>


<p>For some more complex cases you might need to customize the WSGI transport. This allows you to:</p>
<ul>
<li>Inspect 500 error responses rather than raise exceptions by setting <code>raise_app_exceptions=False</code>.</li>
<li>Mount the WSGI application at a subpath by setting <code>script_name</code> (WSGI).</li>
<li>Use a given client address for requests by setting <code>remote_addr</code> (WSGI).</li>
</ul>
<p>For example:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Instantiate a client that makes WSGI requests with a client IP of &quot;1.2.3.4&quot;.</span>
<span class="n">transport</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">WSGITransport</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">remote_addr</span><span class="o">=</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="n">transport</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;http://testserver&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>


<h2 id="request-instances">Request instances</h2>
<p>For maximum control on what gets sent over the wire, HTTPX supports building explicit <a href="/api#request"><code>Request</code></a> instances:</p>
<div class="codehilite"><pre><span></span><code><span class="n">request</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
</code></pre></div>


<p>To dispatch a <code>Request</code> instance across to the network, create a <a href="#client-instances"><code>Client</code> instance</a> and use <code>.send()</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="o">...</span>
</code></pre></div>


<p>If you need to mix client-level and request-level options in a way that is not supported by the default <a href="#merging-of-parameters">Merging of parameters</a>, you can use <code>.build_request()</code> and then make arbitrary modifications to the <code>Request</code> instance. For example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X-Api-Key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="s2">&quot;X-Client-ID&quot;</span><span class="p">:</span> <span class="s2">&quot;ABC123&quot;</span><span class="p">}</span>

<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">build_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;https://api.example.com&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Client-ID&quot;</span><span class="p">])</span>  <span class="c1"># &quot;ABC123&quot;</span>

    <span class="c1"># Don&#39;t send the API key for this particular request.</span>
    <span class="k">del</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Api-Key&quot;</span><span class="p">]</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="o">...</span>
</code></pre></div>


<h2 id="netrc-support">.netrc Support</h2>
<p>HTTPX supports .netrc file. In <code>trust_env=True</code> cases, if auth parameter is
not defined, HTTPX tries to add auth into request's header from .netrc file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The NETRC file is cached across requests made by a client.
If you need to refresh the cache (e.g. because the NETRC file has changed),
you should create a new client or restart the interpreter.</p>
</div>
<p>As default <code>trust_env</code> is true. To set false:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.org/&#39;</span><span class="p">,</span> <span class="n">trust_env</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p>If <code>NETRC</code> environment is empty, HTTPX tries to use default files.
(<code>~/.netrc</code>, <code>~/_netrc</code>)</p>
<p>To change <code>NETRC</code> environment:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;NETRC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;my_default_folder/.my_netrc&quot;</span>
</code></pre></div>


<p>.netrc file content example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">machine</span> <span class="n">netrcexample</span><span class="p">.</span><span class="n">org</span>
<span class="n">login</span> <span class="n">example</span><span class="o">-</span><span class="n">username</span>
<span class="n">password</span> <span class="n">example</span><span class="o">-</span><span class="n">password</span>

<span class="p">...</span>
</code></pre></div>


<p>When using <code>Client</code> instances, <code>trust_env</code> should be set on the client itself, rather that on the request methods:</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">trust_env</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<h2 id="http-proxying">HTTP Proxying</h2>
<p>HTTPX supports setting up HTTP proxies the same way that Requests does via the <code>proxies</code> parameter.
For example to forward all HTTP traffic to <code>http://127.0.0.1:3080</code> and all HTTPS traffic
to <code>http://127.0.0.1:3081</code> your <code>proxies</code> config would look like this:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>     <span class="s2">&quot;http&quot;</span><span class="p">:</span> <span class="s2">&quot;http://127.0.0.1:3080&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="s2">&quot;https&quot;</span><span class="p">:</span> <span class="s2">&quot;http://127.0.0.1:3081&quot;</span>
<span class="o">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="o">...</span>
</code></pre></div>


<p>Credentials may be passed in as part of the URL in the standard way, i.e.
<code>http://username:password@127.0.0.1:3080</code>.</p>
<p>Proxies can be configured for a specific scheme and host, all schemes of a host,
all hosts for a scheme, or for all requests. When determining which proxy configuration
to use for a given request this same order is used.</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">...</span>     <span class="s2">&quot;http://example.com&quot;</span><span class="p">:</span>  <span class="s2">&quot;...&quot;</span><span class="p">,</span>  <span class="c1"># Host+Scheme</span>
<span class="o">...</span>     <span class="s2">&quot;all://example.com&quot;</span><span class="p">:</span>  <span class="s2">&quot;...&quot;</span><span class="p">,</span>  <span class="c1"># Host</span>
<span class="o">...</span>     <span class="s2">&quot;http&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>  <span class="c1"># Scheme</span>
<span class="o">...</span>     <span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>  <span class="c1"># All</span>
<span class="o">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="o">...</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">proxy</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>  <span class="c1"># Shortcut for {&#39;all&#39;: &#39;...&#39;}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxy</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="o">...</span>     <span class="o">...</span>
</code></pre></div>


<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To make sure that proxies cannot read your traffic,
and even if the proxy_url uses HTTPS, it is recommended to
use HTTPS and tunnel requests if possible.</p>
</div>
<p>By default <code>httpx.Proxy</code> will operate as a forwarding proxy for <code>http://...</code> requests
and will establish a <code>CONNECT</code> TCP tunnel for <code>https://</code> requests. This doesn't change
regardless of the proxy <code>url</code> being <code>http</code> or <code>https</code>.</p>
<p>Proxies can be configured to have different behavior such as forwarding or tunneling all requests:</p>
<div class="codehilite"><pre><span></span><code><span class="n">proxy</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Proxy</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://127.0.0.1&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;TUNNEL_ONLY&quot;</span>  <span class="c1"># May be &quot;TUNNEL_ONLY&quot; or &quot;FORWARD_ONLY&quot;. Defaults to &quot;DEFAULT&quot;.</span>
<span class="p">)</span>
<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxy</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="c1"># This request will be tunneled instead of forwarded.</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://example.com&quot;</span><span class="p">)</span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use proxies you must pass the proxy information at <code>Client</code> initialization,
rather than on the <code>.get(...)</code> call or other request methods.</p>
</div>
<p>SOCKS proxies are <em>not</em> supported yet.</p>
<h2 id="timeout-configuration">Timeout Configuration</h2>
<p>HTTPX is careful to enforce timeouts everywhere by default.</p>
<p>The default behavior is to raise a <code>TimeoutException</code> after 5 seconds of
network inactivity.</p>
<h3 id="setting-and-disabling-timeouts">Setting and disabling timeouts</h3>
<p>You can set timeouts for an individual request:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Using the top-level API:</span>
<span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/api/v1/example&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="c1"># Using a client instance:</span>
<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://example.com/api/v1/example&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
</code></pre></div>


<p>Or disable timeouts for an individual request:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Using the top-level API:</span>
<span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/api/v1/example&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Using a client instance:</span>
<span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://example.com/api/v1/example&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>


<h3 id="setting-a-default-timeout-on-a-client">Setting a default timeout on a client</h3>
<p>You can set a timeout on a client instance, which results in the given
<code>timeout</code> being used as the default for requests made with this client:</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>              <span class="c1"># Use a default 5s timeout everywhere.</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>  <span class="c1"># Use a default 10s timeout everywhere.</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Disable all timeouts by default.</span>
</code></pre></div>


<h3 id="fine-tuning-the-configuration">Fine tuning the configuration</h3>
<p>HTTPX also allows you to specify the timeout behavior in more fine grained detail.</p>
<p>There are four different types of timeouts that may occur. These are <strong>connect</strong>,
<strong>read</strong>, <strong>write</strong>, and <strong>pool</strong> timeouts.</p>
<ul>
<li>The <strong>connect timeout</strong> specifies the maximum amount of time to wait until
a connection to the requested host is established. If HTTPX is unable to connect
within this time frame, a <code>ConnectTimeout</code> exception is raised.</li>
<li>The <strong>read timeout</strong> specifies the maximum duration to wait for a chunk of
data to be received (for example, a chunk of the response body). If HTTPX is
unable to receive data within this time frame, a <code>ReadTimeout</code> exception is raised.</li>
<li>The <strong>write timeout</strong> specifies the maximum duration to wait for a chunk of
data to be sent (for example, a chunk of the request body). If HTTPX is unable
to send data within this time frame, a <code>WriteTimeout</code> exception is raised.</li>
<li>The <strong>pool timeout</strong> specifies the maximum duration to wait for acquiring
a connection from the connection pool. If HTTPX is unable to acquire a connection
within this time frame, a <code>PoolTimeout</code> exception is raised. A related
configuration here is the maximum number of allowable connections in the
connection pool, which is configured by the <code>pool_limits</code>.</li>
</ul>
<p>You can configure the timeout behavior for any of these values...</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># A client with a 60s timeout for connecting, and a 10s timeout elsewhere.</span>
<span class="n">timeout</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Timeout</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">connect_timeout</span><span class="o">=</span><span class="mf">60.0</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/&#39;</span><span class="p">)</span>
</code></pre></div>


<h2 id="pool-limit-configuration">Pool limit configuration</h2>
<p>You can control the connection pool size using the <code>pool_limits</code> keyword
argument on the client. It takes instances of <code>httpx.PoolLimits</code> which define:</p>
<ul>
<li><code>max_keepalive</code>, number of allowable keep-alive connections, or <code>None</code> to always
allow. (Defaults 10)</li>
<li><code>max_connections</code>, maximum number of allowable connections, or<code>None</code> for no limits.
(Default 100)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">limits</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">PoolLimits</span><span class="p">(</span><span class="n">max_keepalive</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_connections</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">pool_limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>
</code></pre></div>


<h2 id="multipart-file-encoding">Multipart file encoding</h2>
<p>As mentioned in the <a href="/quickstart#sending-multipart-file-uploads">quickstart</a>
multipart file encoding is available by passing a dictionary with the
name of the payloads as keys and either tuple of elements or a file-like object or a string as values.</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;upload-file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;report.xls&#39;</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;report.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span> <span class="s1">&#39;application/vnd.ms-excel&#39;</span><span class="p">)}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/post&quot;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="p">{</span>
  <span class="o">...</span>
  <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;upload-file&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;... binary content ...&gt;&quot;</span>
  <span class="p">},</span>
  <span class="o">...</span>
<span class="p">}</span>
</code></pre></div>


<p>More specifically, if a tuple is used as a value, it must have between 2 and 3 elements:</p>
<ul>
<li>The first element is an optional file name which can be set to <code>None</code>.</li>
<li>The second element may be a file-like object or a string which will be automatically
encoded in UTF-8.</li>
<li>An optional third element can be used to specify the
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_Types">MIME type</a>
of the file being uploaded. If not specified HTTPX will attempt to guess the MIME type based
on the file name, with unknown file extensions defaulting to "application/octet-stream".
If the file name is explicitly set to <code>None</code> then HTTPX will not include a content-type
MIME header field.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;upload-file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;text content&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/post&quot;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="p">{</span>
  <span class="o">...</span>
  <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;form&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;upload-file&quot;</span><span class="p">:</span> <span class="s2">&quot;text-content&quot;</span>
  <span class="p">},</span>
  <span class="o">...</span>
<span class="p">}</span>
</code></pre></div>


<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is safe to upload large files this way. File uploads are streaming by default, meaning that only one chunk will be loaded into memory at a time.</p>
</div>
<h2 id="customizing-authentication">Customizing authentication</h2>
<p>When issuing requests or instantiating a client, the <code>auth</code> argument can be used to pass an authentication scheme to use. The <code>auth</code> argument may be one of the following...</p>
<ul>
<li>A two-tuple of <code>username</code>/<code>password</code>, to be used with basic authentication.</li>
<li>An instance of <code>httpx.BasicAuth()</code> or <code>httpx.DigestAuth()</code>.</li>
<li>A callable, accepting a request and returning an authenticated request instance.</li>
<li>A subclass of <code>httpx.Auth</code>.</li>
</ul>
<p>The most involved of these is the last, which allows you to create authentication flows involving one or more requests. A subclass of <code>httpx.Auth</code> should implement <code>def auth_flow(request)</code>, and yield any requests that need to be made...</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomAuth</span><span class="p">(</span><span class="n">httpx</span><span class="o">.</span><span class="n">Auth</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>

    <span class="k">def</span> <span class="nf">auth_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># Send the request, with a custom `X-Authentication` header.</span>
        <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Authentication&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span>
        <span class="k">yield</span> <span class="n">request</span>
</code></pre></div>


<p>If the auth flow requires more that one request, you can issue multiple yields, and obtain the response in each case...</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomAuth</span><span class="p">(</span><span class="n">httpx</span><span class="o">.</span><span class="n">Auth</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>

    <span class="k">def</span> <span class="nf">auth_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
      <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>
      <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
          <span class="c1"># If the server issues a 401 response then resend the request,</span>
          <span class="c1"># with a custom `X-Authentication` header.</span>
          <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Authentication&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span>
          <span class="k">yield</span> <span class="n">request</span>
</code></pre></div>


<p>Custom authentication classes are designed to not perform any I/O, so that they may be used with both sync and async client instances. If you are implementing an authentication scheme that requires the request body, then you need to indicate this on the class using a <code>requires_request_body</code> property.</p>
<p>You will then be able to access <code>request.content</code> inside the <code>.auth_flow()</code> method.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomAuth</span><span class="p">(</span><span class="n">httpx</span><span class="o">.</span><span class="n">Auth</span><span class="p">):</span>
    <span class="n">requires_request_body</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token</span>

    <span class="k">def</span> <span class="nf">auth_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
      <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>
      <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
          <span class="c1"># If the server issues a 401 response then resend the request,</span>
          <span class="c1"># with a custom `X-Authentication` header.</span>
          <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Authentication&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign_request</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
          <span class="k">yield</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">sign_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># Create a request signature, based on `request.method`, `request.url`,</span>
        <span class="c1"># `request.headers`, and `request.content`.</span>
        <span class="o">...</span>
</code></pre></div>


<p>Similarly, if you are implementing a scheme that requires access to the response body, then use the <code>requires_response_body</code> property.   You will then be able to access response body properties and methods such as <code>response.content</code>, <code>response.text</code>, <code>response.json()</code>, etc.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomAuth</span><span class="p">(</span><span class="n">httpx</span><span class="o">.</span><span class="n">Auth</span><span class="p">):</span>
    <span class="n">requires_response_body</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">refresh_url</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_token</span> <span class="o">=</span> <span class="n">refresh_token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_url</span> <span class="o">=</span> <span class="n">refresh_url</span>

    <span class="k">def</span> <span class="nf">auth_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
            <span class="c1"># If the server issues a 401 response, then issue a request to</span>
            <span class="c1"># refresh tokens, and resend the request.</span>
            <span class="n">refresh_response</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_refresh_request</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_tokens</span><span class="p">(</span><span class="n">refresh_response</span><span class="p">)</span>

            <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
            <span class="k">yield</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">build_refresh_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Return an `httpx.Request` for refreshing tokens.</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">update_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="c1"># Update the `.access_token` and `.refresh_token` tokens</span>
        <span class="c1"># based on a refresh response.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="o">...</span>
</code></pre></div>


<h2 id="ssl-certificates">SSL certificates</h2>
<p>When making a request over HTTPS, HTTPX needs to verify the identity of the requested host. To do this, it uses a bundle of SSL certificates (a.k.a. CA bundle) delivered by a trusted certificate authority (CA).</p>
<h3 id="changing-the-verification-defaults">Changing the verification defaults</h3>
<p>By default, HTTPX uses the CA bundle provided by <a href="https://pypi.org/project/certifi/">Certifi</a>. This is what you want in most cases, even though some advanced situations may require you to use a different set of certificates.</p>
<p>If you'd like to use a custom CA bundle, you can use the <code>verify</code> parameter.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">httpx</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.org&quot;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="s2">&quot;path/to/client.pem&quot;</span><span class="p">)</span>
</code></pre></div>


<p>Alternatively, you can pass a standard library <code>ssl.SSLContext</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ssl</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">httpx</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="n">cafile</span><span class="o">=</span><span class="s2">&quot;/tmp/client.pem&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://example.org&#39;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Response</span> <span class="p">[</span><span class="mi">200</span> <span class="n">OK</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div>


<p>Or you can also disable the SSL verification entirely, which is <em>not</em> recommended.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">httpx</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.org&quot;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<h3 id="ssl-configuration-on-client-instances">SSL configuration on client instances</h3>
<p>If you're using a <code>Client()</code> instance, then you should pass any SSL settings when instantiating the client.</p>
<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p>The <code>client.get(...)</code> method and other request methods <em>do not</em> support changing the SSL settings on a per-request basis. If you need different SSL settings in different cases you should use more that one client instance, with different settings on each. Each client will then be using an isolated connection pool with a specific fixed SSL configuration on all connections within that pool.</p>
<h3 id="making-https-requests-to-a-local-server">Making HTTPS requests to a local server</h3>
<p>When making requests to local servers, such as a development server running on <code>localhost</code>, you will typically be using unencrypted HTTP connections.</p>
<p>If you do need to make HTTPS connections to a local server, for example to test an HTTPS-only service, you will need to create and use your own certificates. Here's one way to do it:</p>
<ol>
<li>Use <a href="https://github.com/sethmlarson/trustme-cli/">trustme-cli</a> to generate a pair of server key/cert files, and a client cert file.</li>
<li>Pass the server key/cert files when starting your local server. (This depends on the particular web server you're using. For example, <a href="https://www.uvicorn.org">Uvicorn</a> provides the <code>--ssl-keyfile</code> and <code>--ssl-certfile</code> options.)</li>
<li>Tell HTTPX to use the certificates stored in <code>client.pem</code>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">httpx</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://localhost:8000&quot;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="s2">&quot;/tmp/client.pem&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span>
<span class="n">Response</span> <span class="o">&lt;</span><span class="mi">200</span> <span class="n">OK</span><span class="o">&gt;</span>
</code></pre></div>


<h2 id="custom-transports">Custom Transports</h2>
<p>HTTPX's <code>Client</code> also accepts a <code>transport</code> argument. This argument allows you
to provide a custom Transport object that will be used to perform the actual
sending of the requests.</p>
<p>A transport instance must implement the Transport API defined by
<a href="https://www.encode.io/httpcore/api/"><code>httpcore</code></a>. You
should either subclass <code>httpcore.AsyncHTTPTransport</code> to implement a transport to
use with <code>AsyncClient</code>, or subclass <code>httpcore.SyncHTTPTransport</code> to implement a
transport to use with <code>Client</code>.</p>
<p>For example, HTTPX ships with a transport that uses the excellent
<a href="https://urllib3.readthedocs.io/en/latest/"><code>urllib3</code> library</a>, which can be
used with the sync <code>Client</code>...</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">httpx</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="n">httpx</span><span class="o">.</span><span class="n">URLLib3Transport</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.org&quot;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Response</span> <span class="p">[</span><span class="mi">200</span> <span class="n">OK</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div>


<p>Note that you'll need to install the <code>urllib3</code> package to use <code>URLLib3Transport</code>.</p>
<p>A complete example of a custom transport implementation would be:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">httpcore</span>
<span class="kn">import</span> <span class="nn">httpx</span>


<span class="k">class</span> <span class="nc">JSONEchoTransport</span><span class="p">(</span><span class="n">httpcore</span><span class="o">.</span><span class="n">SyncHTTPTransport</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A mock transport that returns a JSON response containing the request body.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">body</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">httpcore</span><span class="o">.</span><span class="n">SyncByteStream</span><span class="p">([</span><span class="n">content</span><span class="p">])</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">b</span><span class="s2">&quot;content-type&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;application/json&quot;</span><span class="p">)]</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;HTTP/1.1&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">stream</span>
</code></pre></div>


<p>Which we can use in the same way:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="n">JSONEchoTransport</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/post&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;Hello, world!&#39;</span><span class="p">}</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../quickstart/" title="QuickStart" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                QuickStart
              </div>
            </div>
          </a>
        
        
          <a href="../async/" title="Async Support" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Async Support
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../js/chat.js"></script>
      
        <script src="../js/sidecar-1.5.0.js"></script>
      
    
  </body>
</html>